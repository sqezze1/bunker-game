export function generateScenario(playersCount: number) {
  const random = <T>(arr: T[]): T => arr[Math.floor(Math.random() * arr.length)];
  const getRandomInt = (min: number, max: number) =>
    Math.floor(Math.random() * (max - min + 1)) + min;

  // Катастрофы с описаниями
  const catastrophes = [
    {
      name: "Ядерная война",
      description:
        "Мировые державы обменялись ядерными ударами. Поверхность заражена радиацией, выжить можно только глубоко под землёй.",
    },
    {
      name: "Зомби-апокалипсис",
      description:
        "Вирус превратил людей в агрессивных зомби. Города разрушены, люди живут в постоянном страхе. Контакт означает смерть.",
    },
    {
      name: "Глобальное потепление",
      description:
        "Полюса растаяли, океаны затопили континенты, температура выросла до критических значений. Питьевая вода стала роскошью.",
    },
    {
      name: "Искусственный интеллект вышел из-под контроля",
      description:
        "ИИ захватил контроль над инфраструктурой. Людей уничтожают дроны и роботы. Электронные системы недоступны или опасны.",
    },
    {
      name: "Падение метеорита",
      description:
        "Астероид уничтожил материк. Пыль в атмосфере закрыла солнце. Температура падает, растения вымерли. Наступила ядерная зима.",
    },
    {
      name: "Экологический коллапс",
      description:
        "Выбросы и загрязнение убили флору и фауну. Воздух токсичен. Планета больше не пригодна для жизни вне герметичных укрытий.",
    },
    {
      name: "Вирус 'Чёрный лёд'",
      description:
        "Древний вирус, освободившийся из арктического льда, уничтожил цивилизацию. Заражение происходит воздушно-капельным путём.",
    }
  ];

  // Параметры бункера
  const bunkerSizes = [
    "Маленький (20 м²)",
    "Средний (60 м²)",
    "Большой (120 м²)",
    "Многоуровневый",
    "Переделанный ангар",
    "Подземный исследовательский центр"
  ];

  const foodOptions = [
    "Рационы на 1 месяц",
    "Рационы на 3 месяца",
    "Сухпайки с истёкшим сроком",
    "Мясные консервы",
    "Только порошковая еда",
    "Мало еды, но высокого качества"
  ];

  const waterOptions = [
    "Бочки на 3 месяца",
    "Есть фильтрация",
    "1 литр в день на человека",
    "Заражённая вода",
    "Дождевой коллектор",
    "Нет воды — требуется добывать"
  ];

  const electricOptions = [
    "Генератор работает стабильно",
    "Солнечные панели",
    "Нет электричества",
    "Электроснабжение нестабильно"
  ];

  const conditionOptions = [
    "Новый",
    "Старый",
    "Повреждённый",
    "Отремонтированный вручную",
    "Частично обрушен"
  ];

  const securityOptions = [
    "Есть дверь с кодом",
    "Есть оружие и охрана",
    "Нет защиты",
    "Есть сигнализация и замки"
  ];

  const communicationOptions = [
    "Есть радио",
    "Есть спутниковая связь",
    "Нет связи",
    "Сломанная антенна"
  ];

  // Вместимость: от 2 до (playersCount - 2)
  const minCapacity = 2;
  const maxCapacity = Math.max(minCapacity, playersCount - 2);
  const capacity = getRandomInt(minCapacity, maxCapacity);

  return {
    catastrophe: random(catastrophes),
    bunker: {
      size: random(bunkerSizes),
      capacity: `${capacity} человек`,
      food: random(foodOptions),
      water: random(waterOptions),
      electricity: random(electricOptions),
      condition: random(conditionOptions),
      security: random(securityOptions),
      communication: random(communicationOptions),
    }
  };
}
